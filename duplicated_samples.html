<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Duplicated Samples Module &mdash; pyGenClean 1.7.1 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.7.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pyGenClean 1.7.1 documentation" href="index.html" />
    <link rel="next" title="Duplicated Markers Module" href="duplicated_markers.html" />
    <link rel="prev" title="pyGenClean.SexCheck package" href="module_content/pyGenClean.SexCheck.html" /> 
  </head>
  <body role="document">

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="py4sci"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="duplicated_markers.html" title="Duplicated Markers Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="module_content/pyGenClean.SexCheck.html" title="pyGenClean.SexCheck package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyGenClean 1.7.1 documentation</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Duplicated Samples Module</a><ul>
<li><a class="reference internal" href="#input-files">Input Files</a></li>
<li><a class="reference internal" href="#procedure">Procedure</a></li>
<li><a class="reference internal" href="#output-files">Output Files</a></li>
<li><a class="reference internal" href="#the-algorithm">The Algorithm</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="module_content/pyGenClean.SexCheck.html"
                        title="previous chapter">pyGenClean.SexCheck package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="duplicated_markers.html"
                        title="next chapter">Duplicated Markers Module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/duplicated_samples.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="duplicated-samples-module">
<span id="dup-samples-label"></span><h1>Duplicated Samples Module<a class="headerlink" href="#duplicated-samples-module" title="Permalink to this headline">¶</a></h1>
<p>The usage of the standalone module is shown below:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> pyGenClean_duplicated_samples --help
<span class="go">usage: pyGenClean_duplicated_samples [-h] [-v] --tfile FILE</span>
<span class="go">                                     [--sample-completion-threshold FLOAT]</span>
<span class="go">                                     [--sample-concordance-threshold FLOAT]</span>
<span class="go">                                     [--out FILE]</span>

<span class="go">Extracts and merges duplicated samples.</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  -v, --version         show program&#39;s version number and exit</span>

<span class="go">Input File:</span>
<span class="go">  --tfile FILE          The input file prefix (will find the tped and tfam</span>
<span class="go">                        file by appending the prefix to .tped and .tfam,</span>
<span class="go">                        respectively.) The duplicated samples should have the</span>
<span class="go">                        same identification numbers (both family and</span>
<span class="go">                        individual ids.)</span>

<span class="go">Options:</span>
<span class="go">  --sample-completion-threshold FLOAT</span>
<span class="go">                        The completion threshold to consider a replicate when</span>
<span class="go">                        choosing the best replicates and for creating the</span>
<span class="go">                        composite samples. [default: 0.9]</span>
<span class="go">  --sample-concordance-threshold FLOAT</span>
<span class="go">                        The concordance threshold to consider a replicate when</span>
<span class="go">                        choosing the best replicates and for creating the</span>
<span class="go">                        composite samples. [default: 0.97]</span>

<span class="go">Output File:</span>
<span class="go">  --out FILE            The prefix of the output files. [default: dup_samples]</span>
</pre></div>
</div>
<div class="section" id="input-files">
<h2>Input Files<a class="headerlink" href="#input-files" title="Permalink to this headline">¶</a></h2>
<p>This module uses PLINK&#8217;s transposed pedfile format (<code class="docutils literal"><span class="pre">tped</span></code> and <code class="docutils literal"><span class="pre">tfam</span></code>
files). For this step to work, the duplicated samples must have the same
identification (family and sample ID). One should keep a file containing the
original identifications before modifying the dataset accordingly.</p>
</div>
<div class="section" id="procedure">
<h2>Procedure<a class="headerlink" href="#procedure" title="Permalink to this headline">¶</a></h2>
<p>Here are the steps performed by the module:</p>
<ol class="arabic simple">
<li>Reads the <code class="docutils literal"><span class="pre">tfam</span></code> file to find duplicated samples.</li>
<li>Separates the duplicated samples from the unique samples.</li>
<li>Writes the unique samples into a file.</li>
<li>Reads the <code class="docutils literal"><span class="pre">tped</span></code> file and write the pedigree file for the unique samples.
Saves in memory the pedigree for the duplicated samples. Updates the indexes
of the duplicated samples.</li>
<li>If there are no duplicated samples, simply create the final file. Stop here.</li>
<li>Computes the completion (for each of the duplicated samples) and the
concordance of each sample pairs.</li>
<li>Prints statistics (concordance and completion).</li>
<li>Prints the concordance matrix for each duplicated samples.</li>
<li>Prints the <code class="docutils literal"><span class="pre">tped</span></code> and the <code class="docutils literal"><span class="pre">tfam</span></code> file for the duplicated samples.</li>
<li>Chooses the best of each duplicates (to keep and to complete) according to
completion and concordance.</li>
<li>Creates a unique <code class="docutils literal"><span class="pre">tped</span></code> and <code class="docutils literal"><span class="pre">tfam</span></code> from the duplicated samples by
completing the best chosen one with the other samples.</li>
<li>Creates the final dataset.</li>
</ol>
</div>
<div class="section" id="output-files">
<h2>Output Files<a class="headerlink" href="#output-files" title="Permalink to this headline">¶</a></h2>
<p>The output files of each of the steps described above are as follow (note that
the output prefix shown is the one by default [<em>i.e.</em> dup_samples]):</p>
<ol class="arabic simple">
<li>No output file is created.</li>
<li>No output file is created.</li>
<li>Only one of the two PLINK&#8217;s transposed pedfiles is created:<ul>
<li><code class="docutils literal"><span class="pre">dup_samples.unique_samples.tfam</span></code>: the <code class="docutils literal"><span class="pre">tfam</span></code> file containing only
the unique samples from the original dataset.</li>
</ul>
</li>
<li>The second of the two PLINK&#8217;s transposed pedfiles is created (see previous
step):<ul>
<li><code class="docutils literal"><span class="pre">dup_samples.unique_samples.tped</span></code>: the <code class="docutils literal"><span class="pre">tped</span></code> file containing only
the unique samples from the original dataset.</li>
</ul>
</li>
<li>If there are not duplicated samples, the final PLINK&#8217;s transposed pedfiles
are created (if not, continue tu next step):<ul>
<li><code class="docutils literal"><span class="pre">dup_samples.final</span></code>: the <code class="docutils literal"><span class="pre">tfam</span></code> and <code class="docutils literal"><span class="pre">tped</span></code> final files.</li>
</ul>
</li>
<li>One result file is created:<ul>
<li><code class="docutils literal"><span class="pre">dup_samples.diff</span></code>: a file containing the differences in the genotypes
for each pair of duplicated samples. Each line contains the following
information: <code class="docutils literal"><span class="pre">name</span></code> the name of the marker, <code class="docutils literal"><span class="pre">famID</span></code> the family ID,
<code class="docutils literal"><span class="pre">indID</span></code> the individual ID, <code class="docutils literal"><span class="pre">dupIndex_1</span></code> the index of the first
duplicated sample in the original dataset (since the identification of
each duplicated samples are the same), <code class="docutils literal"><span class="pre">dupIndex_2</span></code> the index of the
second duplicated sample in the original dataset, <code class="docutils literal"><span class="pre">genotype_1</span></code> and
<code class="docutils literal"><span class="pre">genotype_2</span></code>, the genotype of the first and second duplicated samples
for the current marker, respectively.</li>
</ul>
</li>
<li>One result file is created:<ul>
<li><code class="docutils literal"><span class="pre">dup_samples.summary</span></code>: the completion and summarized concordance of
each duplicated sample pair. The first two columns (<code class="docutils literal"><span class="pre">origIndex</span></code> and
<code class="docutils literal"><span class="pre">dupIndex</span></code> are the indexes of the duplicated sample in the original
and duplicated transposed pedfiles, respectively.</li>
</ul>
</li>
<li>One result file is created<ul>
<li><code class="docutils literal"><span class="pre">dup_samples.concordance</span></code>: the pairwise concordance of each duplicated
samples.</li>
</ul>
</li>
<li>One set of PLINK&#8217;s transposed pedfiles:<ul>
<li><code class="docutils literal"><span class="pre">dup_samples.duplicated_samples</span></code>: the dataset containing the
duplicated samples from the original dataset.</li>
</ul>
</li>
<li>Two output files are created:<ul>
<li><code class="docutils literal"><span class="pre">dup_samples.chosen_samples.info</span></code>: a list of samples that were chosen
for completion according to their completion and summarized concordance
with their duplicates. Again, their indexes in the original and
duplicated transposed pedfiles are saved (the two first columns).</li>
<li><code class="docutils literal"><span class="pre">dup_samples.excluded_samples.info</span></code>: a list of samples that were not
chosen for completion according to their completion and summarized
concordance with their duplicates.</li>
</ul>
</li>
<li>Multiple output files are created, along with on set of PLINK&#8217;s transposed
pedfiles:<ul>
<li><code class="docutils literal"><span class="pre">dup_samples.zeroed_out</span></code>: the list of genotypes that were zeroed out
during completion of the chosen duplicated samples.</li>
<li><code class="docutils literal"><span class="pre">dup_samples.not_good_enough</span></code>: the list of samples that were not good
enough (according to completion and concordance) to create the composite
sample (the chosen duplicated samples).</li>
</ul>
</li>
<li>Two sets of PLINK&#8217;s transposed pedfiles are created:<ul>
<li><code class="docutils literal"><span class="pre">dup_samples.chosen_samples</span></code>: a transposed pedfiles containing the
completed chosen samples.</li>
<li><code class="docutils literal"><span class="pre">dup_samples.final</span></code>: the final dataset.</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="the-algorithm">
<h2>The Algorithm<a class="headerlink" href="#the-algorithm" title="Permalink to this headline">¶</a></h2>
<p>For more information about the actual algorithms and source codes, refer to the
following page.</p>
<ul class="simple">
<li><a class="reference internal" href="module_content/pyGenClean.DupSamples.html#module-pyGenClean.DupSamples.duplicated_samples" title="pyGenClean.DupSamples.duplicated_samples"><code class="xref py py-mod docutils literal"><span class="pre">pyGenClean.DupSamples.duplicated_samples</span></code></a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="duplicated_markers.html" title="Duplicated Markers Module"
             >next</a> |</li>
        <li class="right" >
          <a href="module_content/pyGenClean.SexCheck.html" title="pyGenClean.SexCheck package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyGenClean 1.7.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2012, Louis-Philippe Lemieux Perreault.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>